version: '2'

services:
  baikal:
    image: ckulka/baikal
    build: .
    ports:
      - "443:443"

  backup:
    image: ckulka/awscli:alpine
    environment:
      - AWS_ACCESS_KEY_ID=my-access-key-id
      - AWS_SECRET_ACCESS_KEY=my-access-key-secret
      - AWS_DEFAULT_REGION=eu-central-1
      - BACKUP_LOCAL=/var/www/baikal/Specific
    volumes_from:
      - baikal
    command: /opt/aws-s3-sync-backup.sh

# To manually backup, run docker-compose run --rm backup sh /opt/aws-s3-sync-backup.sh
# To manually restore, run docker-compose run --rm backup sh /opt/aws-s3-sync-restore.sh

